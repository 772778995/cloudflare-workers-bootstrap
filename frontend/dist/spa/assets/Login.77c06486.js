import{f as V,r as g,j as b,o as y,m as v,e as s,I as c,q as e,F as k,Q as C,n as d,J as x,K as E,L as S,M as w}from"./index.18c85594.js";import{u as I,a as L,E as $,b as F,Q,i as B,c as H}from"./useSendEmail.fdc36293.js";import{l as P}from"./localForage.0be1d0f6.js";import"./throwError.f2bb7a95.js";var R=f=>{const{emailInputRef:r}=f,t=V(),m=g(["email","psd"]),i=g({phone:"13777777777",smsCode:"000000",email:"772778995@qq.com",emailCode:"000000",psd:"123456"}),{leftSeconds:o,sendEmailCode:u,isSendEmailCodeLoading:p}=I(),l=async()=>{!await r.value.validate()||u(i.value.email,$.Login)},[n,a]=L(()=>F.post("/login/email/code",i.value));return{loginType:m,leftSeconds:o,sendEmailCodeHandler:l,isSendEmailCodeLoading:p,loginForm:i,isLoginLoading:a,loginHandler:async()=>{const{token:_,userInfo:h}=await n();localStorage.setItem("token",_),await P.setItem("userInfo",h),t.replace({name:"\u9996\u9875"})}}};const q={_flex:"~"},N={_flex:"~"},z={_flex:"1"},U={_m:"l-10px"},M={_m:"l-10px"},A=b({__name:"Login",setup(f){const r=g(),{leftSeconds:t,isSendEmailCodeLoading:m,sendEmailCodeHandler:i,loginForm:o,isLoginLoading:u,loginHandler:p}=R({emailInputRef:r});return(l,n)=>(y(),v("div",q,[s(Q,{_m:"auto",_w:"80vw max-350px",_space:"y-10px",onSubmit:e(p)},{default:c(()=>[(y(),v(k,{key:0},[s(C,{modelValue:e(o).email,"onUpdate:modelValue":n[0]||(n[0]=a=>e(o).email=a),ref_key:"emailInputRef",ref:r,label:l.$t("email"),maxlength:"255",outlined:"","lazy-rules":"",rules:[a=>e(B)(a)||l.$t("Please enter your email")]},null,8,["modelValue","label","rules"]),d("div",N,[d("div",z,[s(C,{modelValue:e(o).emailCode,"onUpdate:modelValue":n[1]||(n[1]=a=>e(o).emailCode=a),label:l.$t("SMS code"),outlined:"",maxlength:"6","lazy-rules":"",rules:[a=>/\d{6}/.test(a)||l.$t("Please enter a 6-digit verification code")]},null,8,["modelValue","label","rules"])]),s(x,{_w:"170px",_m:"l-20px",_h:"56px",color:"primary",icon:"email",loading:e(t)>0||e(m),onClick:e(i)},E({default:c(()=>[d("div",U,S(l.$t("Send Email Code")),1)]),_:2},[e(t)>0?{name:"loading",fn:c(()=>[s(H),d("div",M,S(e(t)),1)]),key:"0"}:void 0]),1032,["loading","onClick"])]),w("",!0)],64)),s(x,{loading:e(u),label:l.$t("login"),icon:"person",color:"primary",_m:"!t-20px",_w:"full",_h:"54px",type:"submit"},null,8,["loading","label"])]),_:1},8,["onSubmit"])]))}});export{A as default};
